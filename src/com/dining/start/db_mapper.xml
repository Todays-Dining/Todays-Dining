<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.mybatis.example.BlogMapper">
	<!-- 
	   태그 : <태그  속성> 텍스트 </태그>
	    id 속성 : 외부(DAO)에서 해당 태그를 지칭하는 (호출하는) 이름, 중복안됨  
	    resultType 속성 : 결과에 대한 속성(select문은 95% VO속성이다)
	       select문에서 집계합수를 사용하면 resultType int 이다.    
	    parameterType 속성 : 대부분 VO속성이다(VO 아니면 전달하는 변수의 자료형이다.)
		<select id="" resultType=""></select>
	    <select id="" resultType="" parameterType=""></select>
	    
	    resultType은 없다. 이유는 무조건 int (숫자)
	    <update id="" parameterType=""></update>
	    <insert id="" parameterType=""></insert>
	    <delete id="" parameterType=""></delete>
	 -->
	
	<!-- <select id="findyourid" parameterType="String" resultType="com.dining.start.db_VO">
	SELECT ID FROM SIGNUP_TABLE WHERE NAME = #{name} AND EMAIL = #{email} AND BIRTHDAY = #{birthday};
	select ID from SIGNUP_TABLE where NAME = #{name} and EMAIL = #{email} and BIRTHDAY = #{birthday}
    </select> -->
    
    
   	<!-- 좌현 ID찾기 -> 아이디 찾기에서 이름, 생년월일, 이메일이 일치하면 그에 맞는 아이디를 db에서 호출  -->
	<select id="findid" resultType="com.dining.start.db_VO"> select ID from SIGNUP_TABLE where name = #{name} and email = #{email} and to_char(birthday,'yymmdd') = #{birthday} </select>
	<select id="findpw" resultType="com.dining.start.db_VO"> select PASSWORD from SIGNUP_TABLE where id = #{id} and PASSWORD_SEARCH_Q = #{password_search_q} and PASSWORD_SEARCH_A = #{password_search_a} </select>
	<!--  <select id="selectId" parameterType="java.util.HashMap" resultType="String">
		select
			id
		from signup_page
		where name = #{name}
		and email = #{email}
		and birthday = cast(#{birthday} as date)
	</select>  -->
    
    <select id="login" resultType="com.dining.start.db_VO">
	    select * from SIGNUP_TABLE where id = #{id} and password = #{password} 
	</select>
    
    <select id="getID" resultType="com.dining.start.db_VO">
        select ID from SIGNUP_TABLE where name = #{name} and email = #{email} and birthday = #{birthday}
    </select>
	
	<select id="idChk" parameterType="String" resultType="com.dining.start.db_VO">
        select ID from SIGNUP_TABLE where ID = #{id}
    </select>
    
	<insert id="infoIns" parameterType="com.dining.start.db_VO">
        insert into SIGNUP_TABLE(STATUS, ID , PASSWORD, NAME, EMAIL, BIRTHDAY, PASSWORD_SEARCH_Q , PASSWORD_SEARCH_A, FAVORITE_LIST, REPORTED_COUNT)
        values(#{status}, #{id} , #{password}, #{name}, #{email}, #{birthday}, #{password_search_q}    , #{password_search_a}, #{favorite_list}, #{reported_count})
    </insert>
    
    <delete id="infoDel" parameterType="com.dining.start.db_VO">
        delete from SIGNUP_TABLE where ID = #{ID}
    </delete>
    
    <update id="infoUpdate" parameterType="com.dining.start.db_VO">
        update SIGNUP_TABLE set ID=#{id}, NAME=#{name}, EMAIL=#{email} , BIRTHDAY=#{birthday}
        , PASSWORD_SEARCH_Q =#{password_search_q} , PASSWORD_SEARCH_A =#{password_search_a}
        where ID = #{id}
    </update>
    
     <select id="pwChk" parameterType="String" resultType="com.dining.start.db_VO">
        select PASSWORD from SIGNUP_TABLE where ID = #{id} 
    </select>

    <select id="getmyid" parameterType="String" resultType="com.dining.start.db_VO">
        select * from SIGNUP_TABLE where ID = #{id}
    </select>
    
    <!-- 재훈 Serach -->
     <select id="Search"  resultType="com.dining.start.db_VO">
        select * from DINER_TABLE where DINER_NAME like '%'||#{search}||'%'
        or MENU like '%'||#{search}||'%' OR food_category like '%'||#{search}||'%'
    </select>
    
</mapper>